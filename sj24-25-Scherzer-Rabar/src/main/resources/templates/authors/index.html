<!DOCTYPE html>
<html lang="en"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout}">
<head>
    <title>Authors</title>
</head>
<body>
<section layout:fragment="content">
    <div class="d-flex justify-content-between align-items-center mb-3">
        <h1>Authors</h1>
        <a th:href="@{/www/authors/add}" class="btn btn-success">Add Author</a>
    </div>


    <div class="card shadow-sm">
        <div class="card-body p-0">
            <div th:if="${error}" class="alert alert-danger">
                <p th:text="${error}"></p>
            </div>
        <div class="card-body p-0">
            <table class="table table-striped table-hover mb-0" id="authors-table">
                <thead class="table-light">
                <tr>
                    <th>Penname</th>
                    <th>Firstname</th>
                    <th>Lastname</th>
                    <th>E-Mail</th>
                    <th>Actions</th>
                </tr>
                </thead>
                <tbody id="authors-tbody" th:fragment="authorsTbody">
                <tr th:each="author : ${authors}">
                    <td th:text="${author.penname}">Penname</td>
                    <td th:text="${author.firstname}">Firstname</td>
                    <td th:text="${author.lastname}">Lastname</td>
                    <td th:text="${author.emailAddress}">E-Mail</td>
                    <td>
                        <div class="d-flex gap-2">
                            <a th:href="@{/www/authors/show/{apiKey}(apiKey=${author.apiKey})}" class="btn btn-outline-secondary btn-sm">Details</a>
                            <a th:href="@{/www/authors/edit/{apiKey}(apiKey=${author.apiKey})}" class="btn btn-outline-primary btn-sm">Edit</a>
                            <form th:action="@{'/www/authors/delete'(apiKey=${author.apiKey})}" method="post"
                                    hx-target="#authors-tbody"
                                    hx-swap="outerHTML"
                                    onsubmit="return confirm('Sure you want to delete?');"
                                    class="d-inline">

                                <button type="submit" class="btn btn-outline-danger btn-sm">Delete</button>
                            </form>
                        </div>
                    </td>
                    </tr>
                    </tbody>
                    </table>
                </div>
            </div>
    </div>
</section>

<script th:src="@{/webjars/bootstrap/5.3.3/dist/css/bootstrap.min.css}"></script>
<script th:src="@{/webjars/bootstrap/5.3.3/dist/js/bootstrap.bundle.min.js}"></script>
<script th:src="@{/webjars/htmx.org/2.0.4/dist/htmx.min.js}"></script>
</body>
</html>
